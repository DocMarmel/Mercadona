<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="UTF-8">
        <title>Mercadona - Création de produit</title>
    </head>
    <body>
        <h1>Création de produit</h1>

        <form id="createProduct" th:action="@{/product/create}" method="post">
            <label for="label">Label:</label>
            <input type="text" id="label" name="label" required><br>

            <label for="description">Description:</label>
            <input type="text" id="description" name="description" required><br>

            <label for="price">Prix:</label>
            <input type="number" id="price" name="price" step="0.01" required><br>

            <label for="category">Catégorie:</label>
            <input type="text" id="category" name="category" required><br>

            <label for="promotion">Promotion:</label>
            <input type="checkbox" id="promotion" name="promotion" onchange="togglePromotionFields(this)"><br>

            <div id="promotionFields" style="display: none;">
                <label for="startDatePromo">Date de début de la promotion:</label>
                <input type="datetime-local" id="startDatePromo" name="startDatePromo"><br>

                <label for="endDatePromo">Date de fin de la Promotion:</label>
                <input type="datetime-local" id="endDatePromo" name="endDatePromo"><br>

                <label for="discountPercentage">Pourcentage de promotion:</label>
                <input type="number" id="discountPercentage" name="discountPercentage"><br>
            </div>

            <input type="submit" value="Créer">
        </form>
    </body>
    <script>
      function togglePromotionFields(checkbox) {
        let promotionFields = document.getElementById("promotionFields");
        let startDatePromoField = document.getElementById("startDatePromo");
        let endDatePromoField = document.getElementById("endDatePromo");
        let discountPercentageField = document.getElementById("discountPercentage");

        promotionFields.style.display = checkbox.checked ? "block" : "none";
        startDatePromoField.required = checkbox.checked;
        endDatePromoField.required = checkbox.checked;
        discountPercentageField.required = checkbox.checked;

      }

      document.getElementById("createProduct").addEventListener("submit", function(event) {
        let promotionCheckbox = document.getElementById("promotion");
        let startDatePromoField = document.getElementById("startDatePromo");
        let endDatePromoField = document.getElementById("endDatePromo");
        let discountPercentageField = document.getElementById("discountPercentage");

        if (promotionCheckbox.checked && (!startDatePromoField.value || !endDatePromoField.value || !discountPercentageField.value)) {
          event.preventDefault();
          alert("S'il vous plait, remplissez tous les champs promotions.");
        }
      });
    </script>
</html>
